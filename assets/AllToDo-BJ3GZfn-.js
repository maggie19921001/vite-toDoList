import{r as v,n as T,o as l,c,F as p,q as $,a as s,t as k,g as r,b as m,s as A,h as E,v as V,d as w}from"./index-BLrGC7K7.js";const L={key:0,class:"no-item"},U={key:1,class:"todoList_item"},z={class:"todoList_label"},B={class:"items"},D=["onUpdate:modelValue","onClick"],F={class:"btns"},N={key:0},M=["onUpdate:modelValue","onChange"],S=["onClick"],q=["onClick"],j=["onClick"],G={class:"todoList_statistics"},_="https://todolist-api.hexschool.io",K={__name:"AllToDo",setup(H){const d=(()=>{const t=document.cookie.split(";");for(let o of t){const[e,h]=o.trim().split("=");if(e==="loginToken")return h;alert("沒有token，請重新登入"),setTimeout(()=>{router.push("/")},1e3)}return null})(),i=v([]),a=v({}),u=async()=>{const t=await r.get(`${_}/todos`,{headers:{Authorization:d}});i.value=t.data.data};u();const g=(t,o)=>{a.value={...a.value,[o]:t.target.value}},f=t=>{const o=i.value.find(e=>e.id===t);o&&(o.isEditing=!o.isEditing,a.value[t]=o.content)},C=async t=>{const o=i.value.find(e=>e.id===t);o.content=a.value[t],await r.put(`${_}/todos/${t}`,o,{headers:{Authorization:d}}),o.isEditing=!1,u(),a.value={...a.value,[t]:""}},y=async t=>{confirm("確定要刪除嗎？")==!0&&(await r.delete(`${_}/todos/${t}`,{headers:{Authorization:d}}),u())},b=async t=>{await r.patch(`${_}/todos/${t}/toggle`,{},{headers:{Authorization:d}}),u()},x=T(()=>i.value.filter(t=>t.status==!1).length);return(t,o)=>(l(),c(p,null,[i.value.length===0?(l(),c("div",L,"目前尚無待辦事項")):(l(),c("ul",U,[(l(!0),c(p,null,$(i.value,(e,h)=>(l(),c("li",{key:h},[s("label",z,[s("div",B,[m(s("input",{class:"todoList_input",type:"checkbox","onUpdate:modelValue":n=>e.status=n,onClick:n=>b(e.id)},null,8,D),[[A,e.status]]),E(" "+k(e.content),1)]),s("div",F,[e.isEditing?(l(),c("div",N,[m(s("input",{type:"text","onUpdate:modelValue":n=>a.value[e.id]=n,onChange:n=>g(n,e.id)},null,40,M),[[V,a.value[e.id]]]),s("button",{type:"button",onClick:n=>C(e.id)},"確定",8,S)])):w("",!0),s("button",{type:"button",onClick:n=>f(e.id)},"編輯",8,q),s("button",{type:"button",onClick:n=>y(e.id)},"刪除",8,j)])])]))),128))])),s("div",G,[s("p",null,k(x.value)+" 個待完成項目",1)])],64))}};export{K as default};
