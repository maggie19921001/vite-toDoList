import{r as c,j as L,k as C,l as w,o as y,c as D,a as t,t as A,b as $,v as B,e as l,f as h,u as N,g as r,h as _,m as O}from"./index-DnRYwDh1.js";const R={id:"todoListPage",class:"bg-half"},V=t("h1",null,"ONLINE TODO LIST",-1),b={class:"todo_sm"},z={class:"container todoListPage vhContainer"},E={class:"todoList_Content"},S={class:"inputBox"},F={class:"todoList_list"},I={class:"todoList_tab"},M={class:"todoList_items"},u="https://todolist-api.hexschool.io",q={__name:"ToDoList",setup(P){const s=(()=>{const o=document.cookie.split(";");for(let e of o){const[i,d]=e.trim().split("=");if(i==="loginToken")return d;alert("沒有token，請重新登入"),setTimeout(()=>{a.push("/")},1e3)}return null})(),p=c({nickname:"",uid:""}),v=c(""),g=async()=>{try{const o=await r.get(`${u}/users/checkout`,{headers:{Authorization:s}});p.value=o.data}catch(o){v.value=o.message,console.log("錯誤訊息",v),alert("驗證失敗，請重新登入"),setTimeout(()=>{a.push("/")},1e3)}},a=L(),f=async()=>{try{const o=await r.post(`${u}/users/sign_out`,{},{headers:{Authorization:s}}),e=new Date;e.setDate(e.getDate()-1),document.cookie=`loginToken=${s}; expires=${e.toUTCString()}`,a.push("/login")}catch(o){console.log(o.message)}},x=c([]),k={content:""},n=c(""),m=async()=>{const o=await r.get(`${u}/todos`,{headers:{Authorization:s}});console.log(o.data),x.value=o.data.data},T=async()=>{n!=null&&(k.content=n.value),await r.post(`${u}/todos`,k,{headers:{Authorization:s}}),n.value="",a.replace({path:a.currentRoute.value.path})};return C(()=>{s&&(g(),m())}),(o,e)=>{const i=w("RouterLink");return y(),D("div",R,[t("nav",null,[V,t("ul",null,[t("li",b,[t("a",{onClick:m},[t("span",null,A(p.value.nickname)+"的代辦",1)])]),t("li",null,[t("a",{href:"#",onClick:f},"登出")])])]),t("div",z,[t("div",E,[t("div",S,[$(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":e[0]||(e[0]=d=>n.value=d)},null,512),[[B,n.value]]),t("button",{onClick:T,class:"fa fa-plus"},"＋")]),t("div",F,[t("ul",I,[t("li",null,[l(i,{to:"/todo","exact-active-class":"active"},{default:h(()=>[_("全部")]),_:1})]),t("li",null,[l(i,{to:"/todo/undone","exact-active-class":"active"},{default:h(()=>[_("未完成")]),_:1})]),t("li",null,[l(i,{to:"/todo/completed","exact-active-class":"active"},{default:h(()=>[_("已完成")]),_:1})])]),t("div",M,[l(N(O))])])])])])}}};export{q as default};
