import{r as p,n as T,o as l,c,F as v,q as $,a as s,t as k,g as r,b as m,s as A,h as E,v as V,d as w}from"./index-CHoBvRcG.js";const L={key:0,class:"no-item"},z={key:1,class:"todoList_item"},B={class:"todoList_label"},D={class:"items"},F=["onUpdate:modelValue","onClick"],U={class:"btns"},N={key:0},M=["onUpdate:modelValue","onChange"],S=["onClick"],q=["onClick"],j=["onClick"],G={class:"todoList_statistics"},_="https://todolist-api.hexschool.io",K={__name:"AllToDo",setup(H){const d=(()=>{const t=document.cookie.split(";");for(let o of t){const[e,h]=o.trim().split("=");if(e==="loginToken")return h;alert("沒有token，請重新登入"),setTimeout(()=>{router.push("/")},1e3)}return null})(),a=p([]),i=p({}),u=async()=>{const t=await r.get(`${_}/todos`,{headers:{Authorization:d}});a.value=t.data.data};u();const g=(t,o)=>{i.value={...i.value,[o]:t.target.value}},f=t=>{const o=a.value.find(e=>e.id===t);o&&(o.isEditing=!o.isEditing,i.value[t]=o.content)},C=async t=>{const o=a.value.find(e=>e.id===t);o.content=i.value[t],await r.put(`${_}/todos/${t}`,o,{headers:{Authorization:d}}),o.isEditing=!1,u(),i.value={...i.value,[t]:""}},y=async t=>{confirm("確定要刪除嗎？")==!0&&(await r.delete(`${_}/todos/${t}`,{headers:{Authorization:d}}),u())},b=async t=>{await r.patch(`${_}/todos/${t}/toggle`,{},{headers:{Authorization:d}}),u()},x=T(()=>a.value.filter(t=>t.status).length);return(t,o)=>(l(),c(v,null,[a.value.length===0?(l(),c("div",L,"目前尚無待辦事項")):(l(),c("ul",z,[(l(!0),c(v,null,$(a.value,(e,h)=>(l(),c("li",{key:h},[s("label",B,[s("div",D,[m(s("input",{class:"todoList_input",type:"checkbox","onUpdate:modelValue":n=>e.status=n,onClick:n=>b(e.id)},null,8,F),[[A,e.status]]),E(" "+k(e.content),1)]),s("div",U,[e.isEditing?(l(),c("div",N,[m(s("input",{type:"text","onUpdate:modelValue":n=>i.value[e.id]=n,onChange:n=>g(n,e.id)},null,40,M),[[V,i.value[e.id]]]),s("button",{type:"button",onClick:n=>C(e.id)},"確定",8,S)])):w("",!0),s("button",{type:"button",onClick:n=>f(e.id)},"編輯",8,q),s("button",{type:"button",onClick:n=>y(e.id)},"刪除",8,j)])])]))),128))])),s("div",G,[s("p",null,k(x.value)+" 個已完成項目",1)])],64))}};export{K as default};
