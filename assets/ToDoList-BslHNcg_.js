import{r as i,j as L,k as C,l as y,o as w,c as A,a as t,t as B,b as N,v as O,e as l,f as h,u as R,g as r,h as _,m as V}from"./index-CHoBvRcG.js";const b={id:"todoListPage",class:"bg-half"},z=t("h1",null,"ONLINE TODO LIST",-1),D={class:"todo_sm"},$={class:"container todoListPage vhContainer"},E={class:"todoList_Content"},F={class:"inputBox"},I={class:"todoList_list"},M={class:"todoList_tab"},P={class:"todoList_items"},u="https://todolist-api.hexschool.io",q={__name:"ToDoList",setup(S){const e=(()=>{const o=document.cookie.split(";");for(let c of o){const[n,d]=c.trim().split("=");if(n==="loginToken")return d;alert("沒有token，請重新登入"),setTimeout(()=>{s.push("/")},1e3)}return null})(),p=i({nickname:"",uid:""}),v=i(""),f=async()=>{try{const o=await r.get(`${u}/users/checkout`,{headers:{Authorization:e}});p.value=o.data}catch(o){v.value=o.message,console.log("錯誤訊息",v),alert("驗證失敗，請重新登入"),setTimeout(()=>{s.push("/")},1e3)}},s=L(),g=async()=>{try{const o=await r.post(`${u}/users/sign_out`,{},{headers:{Authorization:e}});s.push("/login")}catch(o){console.log(o.message)}},x=i([]),k={content:""},a=i(""),m=async()=>{const o=await r.get(`${u}/todos`,{headers:{Authorization:e}});console.log(o.data),x.value=o.data.data},T=async()=>{a!=null&&(k.content=a.value),await r.post(`${u}/todos`,k,{headers:{Authorization:e}}),a.value="",s.replace({path:s.currentRoute.value.path})};return C(()=>{e&&(f(),m())}),(o,c)=>{const n=y("RouterLink");return w(),A("div",b,[t("nav",null,[z,t("ul",null,[t("li",D,[t("a",{onClick:m},[t("span",null,B(p.value.nickname)+"的代辦",1)])]),t("li",null,[t("a",{href:"#",onClick:g},"登出")])])]),t("div",$,[t("div",E,[t("div",F,[N(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":c[0]||(c[0]=d=>a.value=d)},null,512),[[O,a.value]]),t("button",{onClick:T,class:"fa fa-plus"},"＋")]),t("div",I,[t("ul",M,[t("li",null,[l(n,{to:"/todo","exact-active-class":"active"},{default:h(()=>[_("全部")]),_:1})]),t("li",null,[l(n,{to:"/todo/undone","exact-active-class":"active"},{default:h(()=>[_("未完成")]),_:1})]),t("li",null,[l(n,{to:"/todo/completed","exact-active-class":"active"},{default:h(()=>[_("已完成")]),_:1})])]),t("div",P,[l(R(V))])])])])])}}};export{q as default};
